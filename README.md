# Born2beroot
project based on knowing how the virtualization work


my notes :

b2b project

1 - partitioning and installation 
mohabid pass : BobbyBlunders3
2 - sudo command doesn't exist : 
su -
apt install sudo
sudo apt install inetutils-hostname (or coreutils) to add the hostname command if not found.

3 - add a user to sudo grp :sudo visudo
create sexypsestatuspl group command : sudo groupadd sexyppl
add to a user to a group : sudo usermod -aG sexyppl mohabid42
delete a user from a group : sudo usermod -G sexyppl mohabid42
delete user's group : sudo groupdel mohabid42
create the user's group with the same gid = sudo groupadd -g GID groupname
run the command id to see the users infos or cat /etc/group

sudo apt install policycoreutils
sestatus (command to check if SElinux enabled or not)

4 - SSH setup :
 I -  Install openSSH server : 
sudo apt update
sudo apt install openssh-server

II -  Configure SSH to use port 4242
sudo nano /etc/ssh/sshd_config (port 22 to 4242)
permitRootLogin no
You have to configure your operating system with the UFW (or firewalld for Rocky)
firewall and thus leave only port 4242 open : 
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw allow 4242/tcp
sudo ufw enable
sudo ufw status verbose
sudo systemctl restart sshd
sudo lsof -i -n -P | grep LISTEN // verify 4242 port active
from another machine : ssh -p 4242 mohabid42@10.14.60.26

III -The use of SSH will be tested during the defense by setting up a new account. You must therefore understand how it works:
sudo adduser simo
ssh-keygen
hostname -I(uppercase i to take server ip) output = 127.0.0.1
ssh-copy-id simo@127.0.0.1
then you run the same command and be able to login without any password.

IV - Change of the hostname to mohabid42 :
sudo hostnamectl set-hostname mohabid42

5 : password policy configuration :

I - sudo apt install libpam-pwquality
II - sudo nano /etc/pam.d/common-password


sudo nano etc/login.defs
PASS_MAX_DAYS 30 // pass day expiration
PASS_MIN_DAYS 2 // min day for new pass
PASS_WARN_AGE 7 // basically 23 days then you get a pass warning
sudo chage --maxdays 30 --mindays 2 --warndays 7 mohabid
chage -l mohabid // verify

III - sudo nano /etc/sudoers 
Defaults        logfile="/var/log/sudo/sudo.log"
Defaults        passwd_tries=3
Defaults        requiretty
Defaults        secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin"

6 - each action using sudo has to be archieved, both inputs and outputs in the logfile /var/log/sudo/sudo.log
Defaults log_input, log_output
Defaults logfile="/var/log/sudo/sudo.log"
 log_input: This option logs all input (commands) that are executed with sudo.
  log_output: This option logs all output generated by those commands.
  logfile: This specifies the path to your custom log file.

7 - monitoring script :
Create a service file for your script:
crontab -e // add excutable command
crontab -l // see your scheduled tasks
crontab -r // remove services

8- bonus 
sudo apt-get update
sudo apt-get upgrade
sudo apt-get install lighttpd
sudo systemctl start lighttpd
sudo systemctl enable lighttpd
sudo nano /etc/lighttpd/lighttpd.conf
server.port                 = 8080
sudo apt-get install php php-cgi php-fpm php-mysql -y
sudo lighty-enable-mod fastcgi
sudo lighty-enable-mod fastcgi-php
sudo systemctl restart lighttpd
sudo apt-get install mariadb-server mariadb-client -y
sudo systemctl start mariadb
sudo systemctl enable mariadb
sudo mysql_secure_installation
sudo mysql -u root -p
CREATE DATABASE mohabid;
CREATE USER 'mohabid'@'localhost' IDENTIFIED BY 'Ilikemy123@';
GRANT ALL PRIVILEGES ON mohabid.* TO 'mohabid'@'localhost';
FLUSH PRIVILEGES;
EXIT;
cd /var/www/html/
sudo wget https://wordpress.org/latest.tar.gz
sudo tar -xvzf latest.tar.gz
sudo mv wordpress/* ./
sudo rm -rf wordpress latest.tar.gzwww-data:
sudo chown -R www-data /var/www/html/
sudo chmod -R 755 /var/www/html/
sudo nano /var/www/html/wordpress/wp-config.php
{
define( 'DB_NAME', 'wordpress' );
define( 'DB_USER', 'mohabid' );
define( 'DB_PASSWORD', 'simosimo' );
define( 'DB_HOST', 'localhost' );
define( 'DB_CHARSET', 'utf8' );
define( 'DB_COLLATE', '' );
}
sudo systemctl restart lighttpd
xdg-open localhost:8080
wget localhost:8080
cat /var/www/html/index.html
